# Dockerfile.fat
FROM ubuntu:22.04

ENV DEBIAN_FRONTEND=noninteractive \
    PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1

RUN apt-get update && apt-get install -y \
    python3 python3-pip python3-dev build-essential git curl ca-certificates \
 && rm -rf /var/lib/apt/lists/*

WORKDIR /app
COPY requirements.txt ./
RUN pip3 install --no-cache-dir -r requirements.txt

# Експорт моделі під час build (можна й заздалегідь)
COPY export_model.py ./
RUN python3 export_model.py --model mobilenet_v2 --out model.pt

# Копіюємо скрипт і лейбли
COPY inference.py imagenet_class_index.json ./

ENTRYPOINT ["python3", "inference.py"]
